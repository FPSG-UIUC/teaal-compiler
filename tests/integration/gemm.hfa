T1_MN = Tensor(rank_ids=["M", "N"])
t1_m = T1_MN.getRoot()
A_MK = A_KM.swizzleRanks(rank_ids=["M", "K"])
a_m = A_MK.getRoot()
B_NK = B_KN.swizzleRanks(rank_ids=["N", "K"])
b_n = B_NK.getRoot()
for m, (t1_n, a_k) in t1_m << a_m:
    for n, (t1_ref, b_k) in t1_n << b_n:
        for k, (a_val, b_val) in a_k & b_k:
            t1_ref += a_val * b_val
Z_NM = Tensor(rank_ids=["N", "M"])
z_n = Z_NM.getRoot()
T1_NM = T1_MN.swizzleRanks(rank_ids=["N", "M"])
t1_n = T1_NM.getRoot()
C_NM = C_MN.swizzleRanks(rank_ids=["N", "M"])
c_n = C_NM.getRoot()
for n, (z_m, (_, t1_m, c_m)) in z_n << (t1_n | c_n):
    for m, (z_ref, (_, t1_val, c_val)) in z_m << (t1_m | c_m):
        z_ref += a * t1_val + b * c_val