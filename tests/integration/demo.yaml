einsum:
    declaration:
        A: [K, M]
        B: [K, N]
        O_p: [K, M, N]
        O: [M, N]
    expressions:
        - O_p[k, m, n] = A[k, m] * B[k, n]
        - O[m, n] = sum(K).O_p[k, m, n]
mapping:
    loop-order:
        O_p: [M, K, N]
        O: [
