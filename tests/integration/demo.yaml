einsum:
    declaration:
        A: [K, M]
        B: [K, N]
        T: [K, M, N]
        Z: [M, N]
    expressions:
        - T[k, m, n] = A[k, m] * B[k, n]
mapping:
    rank-order:
        A: [K, M]
        B: [K, N]
        T: [M, K, N]
        Z: [M, N]
    partitioning:
        T:
            K: [ uniform_shape(16) ]
            (K0, M): [ flatten() ]
            K0M: [ uniform_occupancy(A.64) ]
        Z:
            K: [ uniform_occupancy(T.64) ]
    loop-order:
        T: [K1, K0M1, K0M0, N]
        Z: [M, K1, K0, N]
