B_NK = B_KN.swizzleRanks(rank_ids=["N", "K"])
b_n = B_NK.getRoot()
A_MK = A_KM.swizzleRanks(rank_ids=["M", "K"])
a_m = A_MK.getRoot()
Z_MN = Tensor(rank_ids=["M", "N"])
z_m = Z_MN.getRoot()
for m, (z_n, a_k) in z_m << a_m:
    for n, (z_ref, b_k) in z_n << b_n:
        for k, (a_val, b_val) in a_k & b_k:
            z_ref += a_val * b_val